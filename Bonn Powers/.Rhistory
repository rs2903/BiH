fill=area),
stat="identity",
position="stack") +
labs(title="Number and categories of 'Bonn Power' decisions per High Representative",
subtitle = "Bild excluded since before Bonn meeting; Inzko as of Dec'18",
caption="graph: author, data: OHR.int")+
theme_thesis()+
theme(legend.position = "bottom",
axis.title=element_blank(),
legend.key.width = unit(0.3, "cm"),
legend.key.height = unit(0.3, "cm"),
panel.grid.major.y = element_blank())+
geom_text(data=Bonn.HR %>% filter(freq>5),
aes(x=as.factor(OHR.label),
y=pos,
label=freq,
group=area),
position=position_stack(vjust=0.5), size=2)+
geom_text(data=Bonn.HR %>% group_by(HR) %>% slice(1),
aes(label=total, y=pos, x=as.factor(OHR.label)),
size=2,
fontface="italic")+
scale_fill_nord(palette="baie_mouton", discrete=TRUE)+
scale_x_discrete(expand=expand_scale(mult=c(0,0.1)))+
scale_y_continuous(expand=expand_scale(mult=c(0,0.1)), minor_breaks = NULL)+
guides(fill=guide_legend(ncol=2, keywidth = 0.3, keyheight=0.3, reverse = TRUE))+
coord_flip()
print(Bonn.HR.col)
#position_stacK: important to add group=
Bonn.HR.col <- Bonn.HR %>%
filter(!str_detect(OHR.label, "Bildt")) %>%
ggplot()+
geom_bar(aes(as.factor(OHR.label),
as.numeric(freq),
group=area,
fill=area),
stat="identity",
position="stack") +
labs(title="Number and categories of 'Bonn Power' decisions per High Representative",
subtitle = "Bild excluded since before Bonn meeting; Inzko as of Dec'18",
caption="graph: author, data: OHR.int")+
theme_thesis()+
theme(legend.position = "bottom",
axis.title=element_blank(),
legend.key.width = unit(0.3, "cm"),
legend.key.height = unit(0.3, "cm"),
panel.grid.major.y = element_blank())+
# geom_text(data=Bonn.HR %>% filter(freq>5),
#           aes(x=as.factor(OHR.label),
#               y=pos,
#               label=freq,
#               group=area),
#           position=position_stack(vjust=0.5), size=2)+
geom_text(data=Bonn.HR %>% group_by(HR) %>% slice(1),
aes(label=total, y=pos, x=as.factor(OHR.label)),
size=2,
fontface="italic")+
scale_fill_nord(palette="baie_mouton", discrete=TRUE)+
scale_x_discrete(expand=expand_scale(mult=c(0,0.1)))+
scale_y_continuous(expand=expand_scale(mult=c(0,0.1)), minor_breaks = NULL)+
guides(fill=guide_legend(ncol=2, keywidth = 0.3, keyheight=0.3, reverse = TRUE))+
coord_flip()
print(Bonn.HR.col)
#position_stacK: important to add group=
Bonn.HR.col <- Bonn.HR %>%
filter(!str_detect(OHR.label, "Bildt")) %>%
ggplot()+
geom_bar(aes(as.factor(OHR.label),
as.numeric(freq),
group=area,
fill=area),
stat="identity",
position="stack") +
labs(title="Number and categories of 'Bonn Power' decisions per High Representative",
subtitle = "Bild excluded since before Bonn meeting; Inzko as of Dec'18",
caption="graph: author, data: OHR.int")+
theme_thesis()+
theme(legend.position = "bottom",
axis.title=element_blank(),
legend.key.width = unit(0.3, "cm"),
legend.key.height = unit(0.3, "cm"),
panel.grid.major.y = element_blank())+
geom_text(data=Bonn.HR %>% filter(freq>5),
aes(x=as.factor(OHR.label),
y=pos,
label=freq,
group=area),
position=position_stack(vjust=0.5), size=2)+
geom_text(data=Bonn.HR %>% group_by(HR) %>% slice(1),
aes(label=total, y=total+10, x=as.factor(OHR.label)),
size=2,
fontface="italic")+
scale_fill_nord(palette="baie_mouton", discrete=TRUE)+
scale_x_discrete(expand=expand_scale(mult=c(0,0.1)))+
scale_y_continuous(expand=expand_scale(mult=c(0,0.1)), minor_breaks = NULL)+
guides(fill=guide_legend(ncol=2, keywidth = 0.3, keyheight=0.3, reverse = TRUE))+
coord_flip()
print(Bonn.HR.col)
Bonn.HR <- Bonn.HR %>%
group_by(HR) %>%
mutate(cum_sum=cumsum(freq)) %>%
mutate(pos=cum_sum-freq/2)
Bonn.HR
#position_stacK: important to add group=
Bonn.HR.col <- Bonn.HR %>%
filter(!str_detect(OHR.label, "Bildt")) %>%
ggplot()+
geom_bar(aes(as.factor(OHR.label),
as.numeric(freq),
group=area,
fill=area),
stat="identity",
position="stack") +
labs(title="Number and categories of 'Bonn Power' decisions per High Representative",
subtitle = "Bild excluded since before Bonn meeting; Inzko as of Dec'18",
caption="graph: author, data: OHR.int")+
theme_thesis()+
theme(legend.position = "bottom",
axis.title=element_blank(),
legend.key.width = unit(0.3, "cm"),
legend.key.height = unit(0.3, "cm"),
panel.grid.major.y = element_blank())+
geom_text(data=Bonn.HR %>% filter(freq>5),
aes(x=as.factor(OHR.label),
y=pos,
label=freq,
group=area),
#position=position_stack(vjust=0.5),
size=2)+
geom_text(data=Bonn.HR %>% group_by(HR) %>% slice(1),
aes(label=total, y=total+10, x=as.factor(OHR.label)),
size=2,
fontface="italic")+
scale_fill_nord(palette="baie_mouton", discrete=TRUE)+
scale_x_discrete(expand=expand_scale(mult=c(0,0.1)))+
scale_y_continuous(expand=expand_scale(mult=c(0,0.1)), minor_breaks = NULL)+
guides(fill=guide_legend(ncol=2, keywidth = 0.3, keyheight=0.3, reverse = TRUE))+
coord_flip()
print(Bonn.HR.col)
Bonn.HR <- Bonn.HR %>%
group_by(HR) %>%
mutate(cum_sum=cumsum(freq)) %>%
mutate(pos=cum_sum-freq/2)
Bonn.HR
#position_stacK: important to add group=
Bonn.HR.col <- Bonn.HR %>%
#filter(!str_detect(OHR.label, "Bildt")) %>%
ggplot()+
geom_bar(aes(as.factor(OHR.label),
as.numeric(freq),
group=area,
fill=area),
stat="identity",
position="stack") +
labs(title="Number and categories of 'Bonn Power' decisions per High Representative",
subtitle = "Bild excluded since before Bonn meeting; Inzko as of Dec'18",
caption="graph: author, data: OHR.int")+
geom_text(data=Bonn.HR %>% filter(freq>5),
aes(x=as.factor(OHR.label),
y=pos,
label=freq,
group=area),
#position=position_stack(vjust=0.5),
size=2)+
geom_text(data=Bonn.HR %>% group_by(HR) %>% slice(1),
aes(label=total,
y=total+10,
x=as.factor(OHR.label)),
size=2,
fontface="italic")+
theme_thesis()+
theme(legend.position = "bottom",
axis.title=element_blank(),
legend.key.width = unit(0.3, "cm"),
legend.key.height = unit(0.3, "cm"),
panel.grid.major.y = element_blank())+
scale_fill_nord(palette="baie_mouton", discrete=TRUE)+
scale_x_discrete(expand=expand_scale(mult=c(0,0.1)))+
scale_y_continuous(expand=expand_scale(mult=c(0,0.1)), minor_breaks = NULL)+
guides(fill=guide_legend(ncol=2, keywidth = 0.3, keyheight=0.3, reverse = TRUE))+
coord_flip()
print(Bonn.HR.col)
#position_stacK: important to add group=
Bonn.HR.col <- Bonn.HR %>%
#filter(!str_detect(OHR.label, "Bildt")) %>%
ggplot()+
geom_bar(aes(OHR.label,
freq,
group=area,
fill=area),
stat="identity",
position="stack") +
labs(title="Number and categories of 'Bonn Power' decisions per High Representative",
subtitle = "Bild excluded since before Bonn meeting; Inzko as of Dec'18",
caption="graph: author, data: OHR.int")+
geom_text(data=Bonn.HR %>% filter(freq>5),
aes(x=as.factor(OHR.label),
y=pos,
label=freq,
group=area),
#position=position_stack(vjust=0.5),
size=2)+
geom_text(data=Bonn.HR %>% group_by(HR) %>% slice(1),
aes(label=total,
y=total+10,
x=as.factor(OHR.label)),
size=2,
fontface="italic")+
theme_thesis()+
theme(legend.position = "bottom",
axis.title=element_blank(),
legend.key.width = unit(0.3, "cm"),
legend.key.height = unit(0.3, "cm"),
panel.grid.major.y = element_blank())+
scale_fill_nord(palette="baie_mouton", discrete=TRUE)+
scale_x_discrete(expand=expand_scale(mult=c(0,0.1)))+
scale_y_continuous(expand=expand_scale(mult=c(0,0.1)), minor_breaks = NULL)+
guides(fill=guide_legend(ncol=2, keywidth = 0.3, keyheight=0.3, reverse = TRUE))+
coord_flip()
print(Bonn.HR.col)
#position_stacK: important to add group=
Bonn.HR.col <- Bonn.HR %>%
#filter(!str_detect(OHR.label, "Bildt")) %>%
ggplot()+
geom_bar(aes(OHR.label,
freq,
group=area,
fill=area),
stat="identity",
position="stack") +
labs(title="Number and categories of 'Bonn Power' decisions per High Representative",
subtitle = "Bild excluded since before Bonn meeting; Inzko as of Dec'18",
caption="graph: author, data: OHR.int")+
geom_text(data=Bonn.HR %>% filter(freq>5),
aes(x=OHR.label,
y=pos,
label=freq,
group=area),
#position=position_stack(vjust=0.5),
size=2)+
geom_text(data=Bonn.HR %>% group_by(HR) %>% slice(1),
aes(label=total,
y=total+10,
x=as.factor(OHR.label)),
size=2,
fontface="italic")+
theme_thesis()+
theme(legend.position = "bottom",
axis.title=element_blank(),
legend.key.width = unit(0.3, "cm"),
legend.key.height = unit(0.3, "cm"),
panel.grid.major.y = element_blank())+
scale_fill_nord(palette="baie_mouton", discrete=TRUE)+
scale_x_discrete(expand=expand_scale(mult=c(0,0.1)))+
scale_y_continuous(expand=expand_scale(mult=c(0,0.1)), minor_breaks = NULL)+
guides(fill=guide_legend(ncol=2, keywidth = 0.3, keyheight=0.3, reverse = TRUE))+
coord_flip()
print(Bonn.HR.col)
#position_stacK: important to add group=
Bonn.HR.col <- Bonn.HR %>%
#filter(!str_detect(OHR.label, "Bildt")) %>%
ggplot()+
geom_bar(aes(OHR.label,
freq,
group=area,
fill=area),
stat="identity",
position=position_stack()) +
labs(title="Number and categories of 'Bonn Power' decisions per High Representative",
subtitle = "Bild excluded since before Bonn meeting; Inzko as of Dec'18",
caption="graph: author, data: OHR.int")+
geom_text(data=Bonn.HR %>% filter(freq>5),
aes(x=OHR.label,
y=pos,
label=freq,
group=area),
#position=position_stack(vjust=0.5),
size=2)+
geom_text(data=Bonn.HR %>% group_by(HR) %>% slice(1),
aes(label=total,
y=total+10,
x=as.factor(OHR.label)),
size=2,
fontface="italic")+
theme_thesis()+
theme(legend.position = "bottom",
axis.title=element_blank(),
legend.key.width = unit(0.3, "cm"),
legend.key.height = unit(0.3, "cm"),
panel.grid.major.y = element_blank())+
scale_fill_nord(palette="baie_mouton", discrete=TRUE)+
scale_x_discrete(expand=expand_scale(mult=c(0,0.1)))+
scale_y_continuous(expand=expand_scale(mult=c(0,0.1)), minor_breaks = NULL)+
guides(fill=guide_legend(ncol=2, keywidth = 0.3, keyheight=0.3, reverse = TRUE))+
coord_flip()
print(Bonn.HR.col)
#position_stacK: important to add group=
Bonn.HR.col <- Bonn.HR %>%
#filter(!str_detect(OHR.label, "Bildt")) %>%
ggplot()+
geom_bar(aes(OHR.label,
freq,
group=area,
fill=area),
stat="identity",
position=position_stack()) +
labs(title="Number and categories of 'Bonn Power' decisions per High Representative",
subtitle = "Bild excluded since before Bonn meeting; Inzko as of Dec'18",
caption="graph: author, data: OHR.int")+
geom_text(data=Bonn.HR %>% filter(freq>5),
aes(x=OHR.label,
y=pos,
label=freq,
group=area),
#position=position_stack(vjust=0.5),
size=2)+
# geom_text(data=Bonn.HR %>% group_by(HR) %>% slice(1),
#           aes(label=total,
#               y=total+10,
#               x=as.factor(OHR.label)),
#           size=2,
#           fontface="italic")+
theme_thesis()+
theme(legend.position = "bottom",
axis.title=element_blank(),
legend.key.width = unit(0.3, "cm"),
legend.key.height = unit(0.3, "cm"),
panel.grid.major.y = element_blank())+
scale_fill_nord(palette="baie_mouton", discrete=TRUE)+
scale_x_discrete(expand=expand_scale(mult=c(0,0.1)))+
scale_y_continuous(expand=expand_scale(mult=c(0,0.1)), minor_breaks = NULL)+
guides(fill=guide_legend(ncol=2, keywidth = 0.3, keyheight=0.3, reverse = TRUE))+
coord_flip()
print(Bonn.HR.col)
Bonn.HR <- Bonn.HR %>%
group_by(HR) %>%
arrange(area, .by_group=T) %>%
mutate(cum_sum=cumsum(freq)) %>%
mutate(pos=cum_sum-freq/2)
Bonn.HR
#position_stacK: important to add group=
Bonn.HR.col <- Bonn.HR %>%
#filter(!str_detect(OHR.label, "Bildt")) %>%
ggplot()+
geom_bar(aes(OHR.label,
freq,
group=area,
fill=area),
stat="identity",
position=position_stack()) +
labs(title="Number and categories of 'Bonn Power' decisions per High Representative",
subtitle = "Bild excluded since before Bonn meeting; Inzko as of Dec'18",
caption="graph: author, data: OHR.int")+
geom_text(data=Bonn.HR %>% filter(freq>5),
aes(x=OHR.label,
y=pos,
label=freq,
group=area),
position=position_stack(vjust=0.5),
size=2)+
geom_text(data=Bonn.HR %>% group_by(HR) %>% slice(1),
aes(label=total,
y=total+10,
x=as.factor(OHR.label)),
size=2,
fontface="italic")+
theme_thesis()+
theme(legend.position = "bottom",
axis.title=element_blank(),
legend.key.width = unit(0.3, "cm"),
legend.key.height = unit(0.3, "cm"),
panel.grid.major.y = element_blank())+
scale_fill_nord(palette="baie_mouton", discrete=TRUE)+
scale_x_discrete(expand=expand_scale(mult=c(0,0.1)))+
scale_y_continuous(expand=expand_scale(mult=c(0,0.1)), minor_breaks = NULL)+
guides(fill=guide_legend(ncol=2, keywidth = 0.3, keyheight=0.3, reverse = TRUE))+
coord_flip()
print(Bonn.HR.col)
Bonn.HR <- Bonn.HR %>%
group_by(HR) %>%
arrange(area, .by_group=TRUE) %>%
mutate(cum_sum=cumsum(freq)) %>%
mutate(pos=cum_sum-freq/2)
Bonn.HR <- Bonn.HR %>%
group_by(HR) %>%
arrange(area, .by_group=TRUE) %>%
mutate(cum_sum=cumsum(freq)) %>%
mutate(pos=cum_sum-freq/2) %>%
ungroup()
#position_stacK: important to add group=
Bonn.HR.col <- Bonn.HR %>%
#filter(!str_detect(OHR.label, "Bildt")) %>%
ggplot()+
geom_bar(aes(OHR.label,
freq,
group=area,
fill=area),
stat="identity",
position=position_stack()) +
labs(title="Number and categories of 'Bonn Power' decisions per High Representative",
subtitle = "Bild excluded since before Bonn meeting; Inzko as of Dec'18",
caption="graph: author, data: OHR.int")+
geom_text(data=Bonn.HR %>% filter(freq>5),
aes(x=OHR.label,
y=pos,
label=freq,
group=area),
position=position_stack(vjust=0.5),
size=2)+
geom_text(data=Bonn.HR %>% group_by(HR) %>% slice(1),
aes(label=total,
y=total+10,
x=as.factor(OHR.label)),
size=2,
fontface="italic")+
theme_thesis()+
theme(legend.position = "bottom",
axis.title=element_blank(),
legend.key.width = unit(0.3, "cm"),
legend.key.height = unit(0.3, "cm"),
panel.grid.major.y = element_blank())+
scale_fill_nord(palette="baie_mouton", discrete=TRUE)+
scale_x_discrete(expand=expand_scale(mult=c(0,0.1)))+
scale_y_continuous(expand=expand_scale(mult=c(0,0.1)), minor_breaks = NULL)+
guides(fill=guide_legend(ncol=2, keywidth = 0.3, keyheight=0.3, reverse = TRUE))+
coord_flip()
print(Bonn.HR.col)
#position_stacK: important to add group=
Bonn.HR.col <- Bonn.HR %>%
#filter(!str_detect(OHR.label, "Bildt")) %>%
ggplot()+
geom_bar(aes(OHR.label,
freq,
group=area,
fill=area),
stat="identity",
position=position_stack()) +
labs(title="Number and categories of 'Bonn Power' decisions per High Representative",
subtitle = "Bild excluded since before Bonn meeting; Inzko as of Dec'18",
caption="graph: author, data: OHR.int")+
geom_text(data=Bonn.HR %>% filter(freq>5),
aes(x=OHR.label,
y=pos,
label=freq,
group=area),
#  position=position_stack(vjust=0.5),
size=2)+
geom_text(data=Bonn.HR %>% group_by(HR) %>% slice(1),
aes(label=total,
y=total+10,
x=as.factor(OHR.label)),
size=2,
fontface="italic")+
theme_thesis()+
theme(legend.position = "bottom",
axis.title=element_blank(),
legend.key.width = unit(0.3, "cm"),
legend.key.height = unit(0.3, "cm"),
panel.grid.major.y = element_blank())+
scale_fill_nord(palette="baie_mouton", discrete=TRUE)+
scale_x_discrete(expand=expand_scale(mult=c(0,0.1)))+
scale_y_continuous(expand=expand_scale(mult=c(0,0.1)), minor_breaks = NULL)+
guides(fill=guide_legend(ncol=2, keywidth = 0.3, keyheight=0.3, reverse = TRUE))+
coord_flip()
print(Bonn.HR.col)
levels(Bonn.HR$area)
levels(Bonn.HR$area)
Bonn.HR <- Bonn.HR %>%
mutate(area=area %>% as.factor) %>%
group_by(HR) %>%
arrange(area, .by_group=TRUE) %>%
mutate(cum_sum=cumsum(freq)) %>%
mutate(pos=cum_sum-freq/2) %>%
ungroup()
#position_stacK: important to add group=
Bonn.HR.col <- Bonn.HR %>%
#filter(!str_detect(OHR.label, "Bildt")) %>%
ggplot()+
geom_bar(aes(OHR.label,
freq,
group=area,
fill=area),
stat="identity",
position=position_stack()) +
labs(title="Number and categories of 'Bonn Power' decisions per High Representative",
subtitle = "Bild excluded since before Bonn meeting; Inzko as of Dec'18",
caption="graph: author, data: OHR.int")+
geom_text(data=Bonn.HR %>% filter(freq>5),
aes(x=OHR.label,
y=pos,
label=freq,
group=area),
#  position=position_stack(vjust=0.5),
size=2)+
geom_text(data=Bonn.HR %>% group_by(HR) %>% slice(1),
aes(label=total,
y=total+10,
x=as.factor(OHR.label)),
size=2,
fontface="italic")+
theme_thesis()+
theme(legend.position = "bottom",
axis.title=element_blank(),
legend.key.width = unit(0.3, "cm"),
legend.key.height = unit(0.3, "cm"),
panel.grid.major.y = element_blank())+
scale_fill_nord(palette="baie_mouton", discrete=TRUE)+
scale_x_discrete(expand=expand_scale(mult=c(0,0.1)))+
scale_y_continuous(expand=expand_scale(mult=c(0,0.1)), minor_breaks = NULL)+
guides(fill=guide_legend(ncol=2, keywidth = 0.3, keyheight=0.3, reverse = TRUE))+
coord_flip()
print(Bonn.HR.col)
